<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>Comic Canvas</title>
	<link rel="stylesheet" href="style.css">
	<script src="script.js"></script>
</head>

<body>

	<div class="main-content">
		<!--General Context	-->
		<div id="settingForm" class="container">
			<h1 class="headline">Comic Canvas</h1>
			<input id="title" class="title" type="text" placeholder="Give your story a title..." maxlength="50">
			<textarea class="textbox" maxlength="200" placeholder="Craft your own reality..." id="setting"></textarea>
			<div class="dropdowns">
				<select class="dropdown" id="style">
					<option value="">Select style</option>
					<option value="Superhero">Superhero</option>
					<option value="Manga">Manga</option>
					<option value="Cyberpunk">Cyberpunk</option>
					<option value="Realistic">Realistic</option>
				</select>
				<select class="dropdown" id="genre">
					<option value="">Select genre</option>
					<option value="Science Fiction">Science Fiction</option>
					<option value="Horror">Horror</option>
					<option value="Fantasy">Fantasy</option>
					<option value="Comedy">Comedy</option>
				</select>
			</div>
			<div class="characters">

				<h2>Characters</h2>
				<div class="character-images">
					<div class="image">
						<img src="images/character_1.png">
						<div class="input-sections">
							<input class="name" type="text" placeholder="Name" id="character_1_name">
							<select class="gender-dropdown" id="character_1_gender">
								<option value="">Select gender</option>
								<option value="female">female</option>
								<option value="male">male</option>
								<option value="other">other</option>
							</select>
							<div class="mini-heading">apearance</div>
							<textarea class="description" placeholder="How do I look like?"
								id="character_1_look"></textarea>
							<div class="mini-heading">personality</div>
							<textarea class="description" placeholder="Bring me to life!"
								id="character_1_personality"></textarea>
						</div>
					</div>

					<div class="image">
						<img src="images/character_2.png">
						<div class="input-sections">
							<input class="name" type="text" placeholder="Name" id="character_2_name">
							<select class="gender-dropdown" id="character_2_gender">
								<option value="">Select gender</option>
								<option value="female">female</option>
								<option value="male">male</option>
								<option value="other">other</option>
							</select>
							<div class="mini-heading">appearance</div>
							<textarea class="description" placeholder="How do I look like?"
								id="character_2_look"></textarea>
							<div class="mini-heading">personality</div>
							<textarea class="description" placeholder="Bring me to life!"
								id="character_2_personality"></textarea>
						</div>
					</div>

					<div class="image">
						<img src="images/character_3.png">
						<div class="input-sections">
							<input class="name" type="text" placeholder="Name" id="character_3_name">
							<select class="gender-dropdown" id="character_3_gender">
								<option value="">Select gender</option>
								<option value="female">female</option>
								<option value="male">male</option>
								<option value="other">other</option>
							</select>
							<div class="mini-heading">appearance</div>
							<textarea class="description" placeholder="How do I look like?"
								id="character_3_look"></textarea>
							<div class="mini-heading">personality</div>
							<textarea class="description" placeholder="Bring me to life!"
								id="character_3_personality"></textarea>
						</div>
					</div>
				</div>
			</div>
			<button onClick="sendSetting()" class="submit-button" id="submit-setting">Construct Universe</button>
			<hr>
		</div>

		<!--Next page-->
		<form id="storyline_form" class="container">
			<h2>Storyline</h2>
			<textarea class="textbox" maxlength="500" placeholder="What happens next?" id="storyline"></textarea>
			<button class="submit-button">Let your storyline unfold...</button>
		</form>

		<!--Canvas-->
		<div class="containerflex">
			<div class="box1">
				<h2>Layout</h2>
				<div class="hiddenradio">
					<title>Page</title>
					<label>
						<input type="radio" , name="test" value="big" checked>
						<img src="images/comic layout.png" ,alt="Layout1" , width="80" , height="80">
					</label>
					<label>
						<input type="radio" name="test" value="big">
						<img src="images/comic layout 2.png" ,alt="Layout2" width="80" , height="80">
					</label>
					<label>
						<input type="radio" name="test" value="big">
						<img src="images/comic layout 3.png" ,alt="Layout3" width="80" , height="80">
					</label>
				</div>
			</div>
			<!--choose panels-->
			<div class="box2">
				<select class="panels" id="panelselector">
				</select>

			</div>

		</div>
		<div class="container">
			<style>
				/* Set the width of the columns */
				.column1 {
					width: 30%;
					float: left;
				}

				.column2 {
					width: 70%;
					float: left;
				}
			</style>
			<div>
				<div class="column1">
					<form id="panel_description_form">
						<h2>Description</h2>
						<textarea class="textbox" maxlength="700" placeholder="Description"
							id="panel_description"></textarea>
					</form>

					<style>
						/* Style for the dialogue boxes */
						.dialogue {
							display: inline-block;
							padding: 10px;
							background-color: #fff;
							border: 2px solid #67c0c86e;
							border-radius: 15px;
							margin: 10px;
						}

						/* Style for the character names */
						.character-name {
							font-weight: bold;
							margin-right: 10px;
						}
					</style>
					</head>

					<body>


						<!-- First character dialogue -->
						<div class="dialogue">
							<span class="character-name" id="char1">[Character 1]:</span>
							<span class="dialogue-text" id="dialogue1">dialogue</span>
						</div>
						<!-- Second character dialogue -->
						<div class="dialogue">
							<span class="character-name" id="char2">[Character 2]:</span>
							<span class="dialogue-text" id="dialogue2">dialogue</span>
						</div>
						<!-- Third character dialogue -->
						<div class="dialogue">
							<span class="character-name" id="char3">[Character 3]:</span>
							<span class="dialogue-text" id="dialogue3">dialogue</span>
						</div>
						<div>
							<h2>Select an image</h2>
							<input type="file" id="myFileInput">
						</div>

						<div>
							<img id="previewImage" width="300">
						</div>

						<script>
							const fileInput = document.getElementById("myFileInput");
							const previewImage = document.getElementById("previewImage");

							fileInput.addEventListener("change", function () {
								const file = fileInput.files[0];
								const reader = new FileReader();

								reader.addEventListener("load", function () {
									previewImage.src = reader.result;
								}, false);

								if (file) {
									reader.readAsDataURL(file);
								}
							});
						</script>
				</div>
			</div>
			<div class="column2">
				<div class="panel">
					<img class="result" src="images/comic layout 3.png" id="panelID" , width=120%,></img>
				</div>
			</div>

		</div>
	</div>
	<div class="sidebar">
		<select class="character-dropdown" id="chat-select">
			<option value="images/panda.png">Writing Buddy</option>
			<option value="images/character_1.png">Character 1</option>
			<option value="images/character_2.png">Character 2</option>
			<option value="images/character_3.png">Character 3</option>
		</select>
		<div class="speech-bubble">
			<p>This is a non-editable text field in the form of a speech bubble.</p>
		</div>
		<img src="images/panda.png" class="avatar" id="chat-image">
		<textarea class="nonresizable-textbox" placeholder="Ask me anything!"></textarea>
		<button class="send-button">Send!</button>
		<!-- your additional content here -->
	</div>
	<script>

		//placeholders
		const writingBuddyDefaultText = "Are there any specific ideas you have for the story or characters that you'd like me to help with? I'm here to help you explore your creativity and bring your vision to life."
		const character1DefaultText = "Ask me anything!"

		//html stuff
		const selectElement = document.getElementById("panelselector");
		selectElement.addEventListener("change", (event) => {
			let selected = event.target.value;
			document.getElementById("panel_description").value = panels[selected]["scenario_description"];
			dialog_list = panels[selected]['dialogues'];

			// first clear all dialogs
			for (let i = 1; i <= 3; i++) {
				document.getElementById("char"+i).innerHTML = "[Character "+i+"]:";
				document.getElementById("dialogue"+i).innerHTML = "dialogue";
			}

			let i = 1;
			for (var key in dialog_list) {
				if (dialog_list.hasOwnProperty(key)) {
					document.getElementById("char"+i).innerHTML = key;
					document.getElementById("dialogue"+i).innerHTML = dialog_list[key];
					i++;
				}
			}
		});


		// panels[panel1][panel1_image]
		// dynamic list for panels
		var panels = {
			1: {
				"scenario_description": "Spiderman and Joker are facing each other on a busy street. The sun is setting in the background, casting an orange glow over the scene. Spiderman is in a crouched position, ready to pounce. Joker is holding a knife, grinning maniacally.\n",
				"dialogues": {
					"Spiderman": "You're not getting away with this, Joker.",
					"Joker": "Oh, but Spiderman, that's the fun part!"
				}
			},
			2: {
				"scenario_description": "Spiderman jumps over a car, narrowly avoiding a swipe from Joker's knife. Joker is now on top of the car, taunting Spiderman. The car is parked near a fruit stand, which Spiderman uses to his advantage.\n",
				"dialogues": {
					"Spiderman": "You're going to have to do better than that, Joker.",
					"Joker": "I'm just getting started, Spiderman!"
				}
			},
			3: {
				"scenario_description": "Spiderman has used his web-slinging ability to wrap Joker up in a bundle of fruit. Joker is squirming and shouting, while Spiderman looks on triumphantly. The police are arriving on the scene to take Joker into custody.\n",
				"dialogues": {
					"Spiderman": "Looks like you're not so tough after all, Joker.",
					"Joker": "This isn't over, Spiderman!",
					"Police officer": "Thanks for your help, Spiderman. We'll take it from here."
				}
			}
		}
		// add to selector
		var select = document.getElementById("panelselector");
		for (var i = 1; i <= Object.keys(panels).length; i++) {
			var opt = document.createElement("option");
			opt.value = i;
			opt.innerHTML = "Panel " + i;
			select.appendChild(opt);
		}
		// document.getElementById("panel_description").value = panels[1]["scenario_description"];

		const chatSelector = document.getElementById('chat-select');

		const imageSelector = document.getElementById('chat-select');
		const image = document.getElementById('chat-image');
		const speechBubble = document.getElementById('chat-speechbubble');

		// add an event listener to the select element
		chatSelector.addEventListener('change', function () {
			// get the selected value
			const selectedValue = chatSelector.value;

			// set the src attribute of the image element to the selected value
			image.src = selectedValue;

		});

		const char1name = document.getElementById("character_1_name")
		const char2name = document.getElementById("character_2_name")
		const char3name = document.getElementById("character_3_name")
		const chatselect = document.getElementById("chat-select")
		char1name.addEventListener('input', function () {
			// get the value of the input field
			var name = char1name.value;
			// update the text of the selected option
			const selectedOption = chatselect.options[1];
			selectedOption.textContent = name;
		});
		char2name.addEventListener('input', function () {
			// get the value of the input field
			var name = char2name.value;
			// update the text of the selected option
			const selectedOption = chatselect.options[2];
			selectedOption.textContent = name;
		});
		char3name.addEventListener('input', function () {
			// get the value of the input field
			var name = char3name.value;
			// update the text of the selected option
			const selectedOption = chatselect.options[3];
			selectedOption.textContent = name;
		});


		//Communicate with server
		var prefix = 'http://192.168.2.2:6969'


		function parseJSON(response) {
			// Check if the response is valid
			if (!response.ok) {
				throw Error(response.statusText);
			}
			// Parse the JSON from the response
			return response.json();
		}

		function postJSON(data) {
			// Make a POST request to the server with the JSON data
			fetch((prefix + '/global'), {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify(data)
			})
				.then(response => {
					// Handle the response from the server
					console.log(response);
				})
				.catch(error => {
					// Handle any errors that occurred during the request
					console.error(error);
				});
		}

		const form = document.getElementById("settingForm");

		function sendSetting() {

			const data = {
				title: document.getElementById("title").value,
				setting: document.getElementById("setting").value,
				style: document.getElementById("style").value,
				genre: document.getElementById("genre").value,
				character_1_name: document.getElementById("character_1_name").value,
				character_1_gender: document.getElementById("character_1_gender").value,
				character_1_look: document.getElementById("character_1_look").value,
				character_1_personality: document.getElementById("character_1_personality").value,
				character_2_name: document.getElementById("character_2_name").value,
				character_2_gender: document.getElementById("character_2_gender").value,
				character_2_look: document.getElementById("character_2_look").value,
				character_2_personality: document.getElementById("character_2_personality").value,
				character_3_name: document.getElementById("character_3_name").value,
				character_3_gender: document.getElementById("character_3_gender").value,
				character_3_look: document.getElementById("character_3_look").value,
				character_3_personality: document.getElementById("character_3_personality").value,
			};

			document.getElementById("storyline").value = "Hold on, currently observing the storyline..."

			// Make a POST request to the server with the JSON data
			fetch((prefix + '/global'), {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify(data)
			})
				.then(response => {
					response.json().then(parsedValue => {
						// code that can access both here
						console.log(parsedValue)
						document.getElementById("storyline").value = parsedValue
					})
				})
				.catch(error => {
					// Handle any errors that occurred during the request
					console.error(error);
				});

		}

		function sendCharacterRequest() {
			data = {
				setting: document.getElementById("setting").value,
				genre: document.getElementById("genre").value,
			}
			// Make a POST request to the server with the JSON data
			fetch((prefix + '/global'), {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify(data)
			})
				.then(response => {
					// Handle the response from the server
					console.log(response);
				})
				.catch(error => {
					// Handle any errors that occurred during the request
					console.error(error);
				});
		}

		// Get the textarea element
		const textarea = document.getElementById('storyline');

		// Set the initial height of the textarea
		textarea.style.height = 'auto';

		// Set the minimum number of rows to 2
		textarea.setAttribute('rows', '2');

		// Calculate the scroll height of the textarea
		const scrollHeight = textarea.scrollHeight;

		// Set the height of the textarea to the scroll height
		textarea.style.height = scrollHeight + 'px';

	</script>

</body>




</html>